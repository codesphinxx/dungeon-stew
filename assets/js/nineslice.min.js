!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("phaser")):"function"==typeof define&&define.amd?define(["phaser"],e):"object"==typeof exports?exports.NineSlice=e(require("phaser")):t.NineSlice=e(t.Phaser)}(window,function(t){return function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(e,i){e.exports=t},function(t,e,i){t.exports=i(2)},function(t,e,i){"use strict";i.r(e);var s=i(0),r=i.n(s);var h=(t,e)=>{var i,s,r,h,o,n,a,u;for(i=3&t.length,s=t.length-i,r=e,o=3432918353,n=461845907,u=0;u<s;)a=255&t.charCodeAt(u)|(255&t.charCodeAt(++u))<<8|(255&t.charCodeAt(++u))<<16|(255&t.charCodeAt(++u))<<24,++u,r=27492+(65535&(h=5*(65535&(r=(r^=a=(65535&(a=(a=(65535&a)*o+(((a>>>16)*o&65535)<<16)&4294967295)<<15|a>>>17))*n+(((a>>>16)*n&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(h>>>16)&65535)<<16);switch(a=0,i){case 3:a^=(255&t.charCodeAt(u+2))<<16;case 2:a^=(255&t.charCodeAt(u+1))<<8;case 1:r^=a=(65535&(a=(a=(65535&(a^=255&t.charCodeAt(u)))*o+(((a>>>16)*o&65535)<<16)&4294967295)<<15|a>>>17))*n+(((a>>>16)*n&65535)<<16)&4294967295}return r^=t.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0};const o=t=>{const e=t;if("number"==typeof e.sourceLayout.width){const{width:t,height:i}=e.sourceLayout;e.sourceLayout={topLeft:{width:t,height:i}}}const i=e.sourceLayout;i.topRight=i.topRight||i.topLeft,i.bottomRight=i.bottomRight||i.topLeft,i.bottomLeft=i.bottomLeft||i.topLeft;const s=Math.max(i.topLeft.height,i.topRight.height),r=Math.max(i.topRight.width,i.bottomRight.width),h=Math.max(i.bottomLeft.height,i.bottomRight.height),o=Math.max(i.topLeft.width,i.bottomLeft.width);if(e.safeOffsets||(e.safeOffsets={top:s,right:r,bottom:h,left:o}),void 0===e.minSizing||!1!==e.minSizing){const t=e.safeOffsets;e.minSizing={width:t?Math.max(t.left+t.right,o+r):o+r,height:t?Math.max(t.top+t.bottom,s+h):s+h}}else e.minSizing=!1;return e},n=t=>({tl:{x:t.topLeft.width,y:t.topLeft.height},tr:{x:t.topRight.width,y:t.topRight.height},bl:{x:t.bottomLeft.width,y:t.bottomLeft.height},br:{x:t.bottomRight.width,y:t.bottomRight.height}}),a="__BASE",u="__MISSING",c={UPDATE_SAFE_BOUNDS:"updatesafebounds"};class d extends r.a.GameObjects.RenderTexture{constructor(t,e,i=null){super(t,0,0,32,32),this.initFrames=this.initFrames.bind(this),this.getUsableBounds=this.getUsableBounds.bind(this),this.drawFrames=this.drawFrames.bind(this),this.resize=this.resize.bind(this),this.updateSafeBounds=this.updateSafeBounds.bind(this),this.enableDebugDraw=this.enableDebugDraw.bind(this),this.events=new r.a.Events.EventEmitter,this.sliceConfig=o(e),this._safeBounds=new r.a.Geom.Rectangle;const{sourceKey:s,sourceFrame:n}=this.sliceConfig;if(this.sourceTex=t.sys.textures.get(this.sliceConfig.sourceKey),!s)throw new Error("NineSlice requires a texture sourceKey to be specified.");if(!this.sourceTex||this.sourceTex.key===u)throw new Error(`Expected source image ${s} not found.`);this._framePrefix=`${h(JSON.stringify({sourceKey:s,sourceFrame:n},404))}`,this.mkFrameName=(t=>`${this._framePrefix}-${t}`),this._frameCache={};const c="string"==typeof n||"number"==typeof n?n:a;this.sourceFrame=this.sourceTex.get(c),this.initFrames(),this._initalized=!0;const{x:d,y:l,width:f,height:g}=i;this.setPosition(d||0,l||0),this.resize(f||this.sourceFrame.width,g||this.sourceFrame.height),this.updateSafeBounds()}updateSafeBounds(){if(!this._initalized)return;const{top:t,right:e,bottom:i,left:s}=this.sliceConfig.safeOffsets,r=this.x+s,h=this.y+t,o=this.width-(s+e),n=this.height-(t+i),{x:a,y:u,width:d,height:l}=this._safeBounds;r===a&&h===u&&o===d&&n===l||(this._safeBounds.setTo(this.x+s,this.y+t,this.width-(s+e),this.height-(t+i)),this.events.emit(c.UPDATE_SAFE_BOUNDS,this,this._safeBounds)),this._g&&(this._g.lineStyle(1,65280),this._g.strokeRectShape(this._safeBounds))}get y(){return this._y}set y(t){this._y!==t&&(this._g&&(this._g.clear(),this.drawFrames()),this._y=t,this.updateSafeBounds())}get x(){return this._x}set x(t){this._x!==t&&(this._g&&(this._g.clear(),this.drawFrames()),this._x=t,this.updateSafeBounds())}resize(t,e){const{minSizing:i}=this.sliceConfig||{},s=i?Math.max(i.height,e):e,r=i?Math.max(i.width,t):t;if(s>e||r>t){const i=`Attempted to set NineSlice size less than minimum (${t}x${e}).`;console.error(i)}super.resize(r,s),this._initalized&&(this._g&&this._g.clear(),this.drawFrames(),this.updateSafeBounds())}initFrames(){const t=this.sourceTex,e=this.sourceFrame.width,i=this.sourceFrame.height,s=this.sourceFrame.cutX,r=this.sourceFrame.cutY,h=(e,i,h,o,n)=>{const a=this.mkFrameName(e);t.has(a)?this._frameCache[e]=t.frames[a]:this._frameCache[e]=t.add(a,0,s+i,r+h,o,n)},o=n(this.sliceConfig.sourceLayout);h("topLeft",0,0,o.tl.x,o.tl.y),h("topRight",e-o.tr.x,0,o.tr.x,o.tr.y),h("bottomRight",e-o.br.x,i-o.br.y,o.br.x,o.br.y),h("bottomLeft",0,i-o.bl.y,o.bl.x,o.bl.y),h("topMiddle",o.tl.x,0,e-(o.tl.x+o.tr.x),Math.max(o.tl.y,o.tr.y)),h("bottomMiddle",o.bl.x,i-Math.max(o.bl.y,o.br.y),e-(o.bl.x+o.br.x),Math.max(o.bl.y,o.br.y)),h("leftMiddle",0,o.tl.y,Math.max(o.tl.x,o.bl.x),i-(o.tl.y+o.bl.y)),h("rightMiddle",e-Math.max(o.tr.x,o.br.x),o.tr.y,Math.max(o.tr.x,o.br.x),i-o.tr.y-o.br.y);const a=Math.min(o.tl.x,o.bl.x),u=Math.min(o.tl.y,o.tr.y);h("center",a,u,e-a-Math.min(o.tr.x,o.br.x),i-u-Math.min(o.br.y,o.bl.y))}getUsableBounds(){return this._initalized?this._safeBounds:null}drawFrames(){if(!this._initalized)return;this._g&&this._g.lineStyle(1,16711680);const t=n(this.sliceConfig.sourceLayout),e=this._frameCache,i=(t,e,i,s,r)=>{if(s>0&&r>0){this._g&&this._g.strokeRect(this.x+e,this.y+i,s,r);const h=this.scene.make.image({key:this.sourceTex.key,frame:t.name,x:0,y:0}),o=s/t.width,n=r/t.height;h.setOrigin(0).setScale(o,n),this.draw(h,e,i),h.destroy()}},s=Math.min(t.tl.x,t.bl.x),r=Math.min(t.tr.x,t.br.x),h=Math.min(t.tl.y,t.tr.y),o=Math.min(t.bl.y,t.br.y);this.clear(),i(e.center,s,h,this.width-s-r,this.height-h-o),i(e.topMiddle,t.tl.x,0,this.width-t.tl.x-t.tr.x,e.topMiddle.height),i(e.bottomMiddle,t.bl.x,this.height-e.bottomMiddle.height,this.width-t.bl.x-t.br.x,e.bottomMiddle.height),i(e.leftMiddle,0,t.tl.y,e.leftMiddle.width,this.height-t.tl.y-t.bl.y),i(e.rightMiddle,this.width-t.tr.x,t.tr.y,e.rightMiddle.width,this.height-t.tr.y-t.br.y),i(e.topLeft,0,0,t.tl.x,t.tl.y),i(e.topRight,this.width-t.tr.x,0,t.tr.x,t.tr.y),i(e.bottomRight,this.width-t.br.x,this.height-t.br.y,t.br.x,t.br.y),i(e.bottomLeft,0,this.height-t.bl.y,t.bl.x,t.bl.y)}enableDebugDraw(t=!0){this._g&&this._g.clear(),this._g=t?this.scene.add.graphics(this.x,this.y):null,this.drawFrames(),this.updateSafeBounds()}}var l=t=>{switch(t.length){case 1:return[t[0],t[0],t[0],t[0]];case 2:return[t[0],t[1],t[0],t[1]];case 3:return[t[0],t[1],t[2],t[1]];case 4:return t}throw new Error("Received ${arr.length} offset values, expected 1 to 4.")};class f extends r.a.Plugins.BasePlugin{constructor(t){super(t),t.registerGameObject("nineslice",this.addNineSlice,this.makeNineSlice)}addNineSlice(...t){const e=g(this.scene,t);return this.displayList.add(e),e}makeNineSlice(...t){return g(this.scene,t)}}const g=(t,e)=>{if(2===e.length)return new d(t,e[0],e[1]);if(e.length<6)throw new Error(`Expected at least 6 arguments to NineSlice creator, received ${e.length}.`);e.length>7&&console.error(`Expected less than 7 arguments for NineSlice creation, received ${e.length}.`);const[i,s,r,h,o,n]=e,a={},u={x:i,y:s,width:r,height:h};if("string"==typeof o)a.sourceKey=o;else{const{key:t,frame:e}=o;a.sourceKey=t,"string"!=typeof e&&"number"!=typeof e||(a.sourceFrame=o.frame)}if("number"==typeof n)a.sourceLayout={width:n,height:n};else if(Array.isArray(n)){const[t,e,i,s]=l(n);a.sourceLayout={topLeft:{width:s,height:t},topRight:{width:e,height:t},bottomRight:{width:e,height:i},bottomLeft:{width:s,height:i}}}else a.sourceLayout=n;if(e.length>6)if("number"==typeof e[6]){const t=e[6];a.safeOffsets={top:t,right:t,bottom:t,left:t}}else{if(!Array.isArray(e[6]))throw new Error(`Expected argument number or array for argument 7, got ${typeof e[6]}.`);{const[t,i,s,r]=l(e[6]);a.safeOffsets={top:t,right:i,bottom:s,left:r}}}return new d(t,a,u)},m={key:"NineSlice",plugin:f,start:!0};f.DefaultCfg=m,i.d(e,"NineSlice",function(){return d}),i.d(e,"EVENTS",function(){return c}),i.d(e,"Plugin",function(){return f})}])});